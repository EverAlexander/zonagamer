<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Snake Gamer</title>
    <style>
        #juego {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        canvas {
            background: #000;
            border: 5px solid #28a745;
            border-radius: 10px;
            cursor: crosshair;
        }

        #puntaje {
            font-size: 20px;
            font-weight: bold;
            margin-top: 10px;
            color: white;
        }
    </style>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
</head>

<body style="background:#111;">

    <div id="juego">
        <h2 style="color:white;">üêç Snake Gamer (Click para mover)</h2>
        <canvas id="snakeCanvas" width="400" height="400"></canvas>
        <div id="puntaje">Puntos: 0</div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.all.min.js"></script>
    <script>
        const canvas = document.getElementById("snakeCanvas");
        const ctx = canvas.getContext("2d");
        const puntajeEl = document.getElementById("puntaje");

        const box = 20; // Tama√±o de cuadrito
        let snake = [{ x: 9 * box, y: 10 * box }];
        let direction = "RIGHT"; // direcci√≥n inicial
        let score = 0;

        // Imagen de comida (moneda Mario)
        const foodImg = new Image();
        foodImg.src = "../imagenes/moneda.png"; // üëà Aseg√∫rate que exista

        let food = {
            x: Math.floor(Math.random() * 19) * box,
            y: Math.floor(Math.random() * 19) * box
        };

        // Detecci√≥n de clic en canvas ‚Üí mover snake
        canvas.addEventListener("click", function (event) {
            const rect = canvas.getBoundingClientRect();
            const clickX = event.clientX - rect.left;
            const clickY = event.clientY - rect.top;

            const head = snake[0];

            // calcular diferencia
            const dx = clickX - head.x;
            const dy = clickY - head.y;

            // decidir direcci√≥n dominante
            if (Math.abs(dx) > Math.abs(dy)) {
                direction = dx > 0 ? "RIGHT" : "LEFT";
            } else {
                direction = dy > 0 ? "DOWN" : "UP";
            }
        });

        function draw() {
            // Fondo
            ctx.fillStyle = "#000";
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Dibujar serpiente
            for (let i = 0; i < snake.length; i++) {
                ctx.fillStyle = (i == 0) ? "#28a745" : "#6f42c1";
                ctx.fillRect(snake[i].x, snake[i].y, box, box);

                ctx.strokeStyle = "#000";
                ctx.strokeRect(snake[i].x, snake[i].y, box, box);
            }

            // Dibujar comida
            ctx.drawImage(foodImg, food.x, food.y, box, box);

            // Posici√≥n cabeza
            let snakeX = snake[0].x;
            let snakeY = snake[0].y;

            if (direction == "LEFT") snakeX -= box;
            if (direction == "UP") snakeY -= box;
            if (direction == "RIGHT") snakeX += box;
            if (direction == "DOWN") snakeY += box;

            // Comer moneda
            if (snakeX == food.x && snakeY == food.y) {
                score++;
                food = {
                    x: Math.floor(Math.random() * 19) * box,
                    y: Math.floor(Math.random() * 19) * box
                };
            } else {
                snake.pop();
            }

            // Nueva cabeza
            const newHead = { x: snakeX, y: snakeY };

            // Game Over
            if (snakeX < 0 || snakeY < 0 || snakeX >= canvas.width || snakeY >= canvas.height || colision(newHead, snake)) {
                clearInterval(juego);
                Swal.fire({
                    title: "üíÄ ¬°Perdiste!",
                    text: "Puntaje final: " + score,
                    icon: "error",
                    confirmButtonText: "Reintentar"
                }).then(() => location.reload());
            }

            snake.unshift(newHead);
            puntajeEl.textContent = "Puntos: " + score;
        }

        function colision(head, arr) {
            for (let i = 0; i < arr.length; i++) {
                if (head.x == arr[i].x && head.y == arr[i].y) {
                    return true;
                }
            }
            return false;
        }

        let juego = setInterval(draw, 150);
    </script>
</body>

</html>
